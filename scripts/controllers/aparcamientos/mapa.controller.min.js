!function(){"use strict";angular.module("Mobipalma").directive("goBackHistory",["$window",function(o){return{restrict:"A",link:function(t,i,n){i.on("click",function(t){t.stopPropagation(),o.history.length?o.history.back():o.close()})}}}]).controller("Aparcamientos.MapaController",["TokenService","$scope","DataFactory","uiGmapGoogleMapApi","$q",function(o,t,i,n,a){function e(o){t.resultado="",t.datos=o.data,t.datosComplementarios=[];for(var n=[],e=(a.defer(),0);e<t.datos.length-2;e++)n.push(i.getAparcamiento(t.datos[e].id));a.all(n).then(function(o){l(t.datos,o)}).catch(void 0)}function l(o,i){for(var a=0;a<i.length;a++)t.mapas.push({id:o[a].id,coords:{latitude:o[a].latitud,longitude:o[a].longitud},nombre:o[a].nombre,plazas:o[a].numeroPlazas,plazasLibres:i[a].data.plazasLibres,estado:i[a].data.nivel});n.then(function(o){})}t.mapas=[],console.log("Aparcamientos.MapaController loaded"),i.getAparcamientos().then(function(o){e(o)},function(o){}),t.map={center:{latitude:39.5823334,longitude:2.6456419},zoom:14},t.windowOptions={visible:!1},t.onClick=function(){t.windowOptions.visible=!t.windowOptions.visible},t.closeClick=function(){t.windowOptions.visible=!1},t.title="Datos del aparcamiento"}])}();